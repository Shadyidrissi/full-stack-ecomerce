import{inspect}from"node:util";

import{getColors}from"./colors.js";
import{prettifyError}from"./pretty.js";
import{omitProps}from"./props.js";
import{
omitStack,
restoreStack,
omitStackBracket,
PRINT_MAX_DEPTH}from
"./stack.js";







export const printError=({
error,
silent,
stack,
props,
colors,
icon,
header
})=>{
if(silent){
return
}

const{addStyles,useColors}=getColors(colors);
const errorString=serializeError({error,stack,props,useColors});
const errorStringA=prettifyError({
error,
errorString,
addStyles,
useColors,
icon,
header
});

console.error(errorStringA)
};

const serializeError=({error,stack,props,useColors})=>{
const errorA=omitProps(error,props);
omitStack(errorA,stack);
const errorString=inspect(errorA,{
colors:useColors,
depth:PRINT_MAX_DEPTH
});
restoreStack(errorA,stack);
const errorStringA=omitStackBracket(errorString);
return errorStringA
};